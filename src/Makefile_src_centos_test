makepath :=$(shell pwd)/$(lastword $(MAKEFILE_LIST))
basepathp :=$(shell dirname $(makepath))
basepath=$(shell dirname $(basepathp))

srcdir=$(basepath)/src
#$(warning $(srcdir))
darwindir=$(basepath)/depends

CC=g++
CFLAGS   = -std=c++11  -fPIC -fvisibility=hidden -O3 -finline-functions -Wno-inline -Wall -pthread -m64

TEST_INCLUDES = -I$(srcdir)/secp256k1/include -I$(darwindir)/x86_64-unknown-linux-gnu/include \
-I$(srcdir) -I$(srcdir)/config -I$(srcdir)/univalue/include  -I$(srcdir)/leveldb/include  -I$(srcdir)/zcash -I/root/jdk1.8.0_171/include -I/root/jdk1.8.0_171/include/linux

$(shell rm -f libzcash.a)
$(shell rm -f bitcoin-cli-ok.o)
$(shell rm -f zcash-cli-ok.so)
$(shell rm -f zcash/libzcash_a-IncrementalMerkleTree.o)

zcash-cli-ok.so: bitcoin-cli-ok.o  libbitcoin_server.a libbitcoin_common.a univalue/.libs/libunivalue.a libbitcoin_util.a crypto/libbitcoin_crypto.a libzcash.a snark/libsnark.a ./leveldb/libleveldb.a ./leveldb/libmemenv.a secp256k1/.libs/libsecp256k1.a libbitcoin_zmq.a  libbitcoin_wallet.a       crypto/libbitcoin_crypto.a
	g++ -shared -fPIC  -m64 -std=c++11  -Wformat -Wformat-security -Wstack-protector -fstack-protector-all -Werror  -pipe -O1 -g -fopenmp -fwrapv -fno-strict-aliasing -Wno-builtin-declaration-mismatch  -pthread   -Wl,-z,relro -Wl,-z,now  -L/home/zcash/depends/x86_64-unknown-linux-gnu/share/../lib  -o  zcash-cli-ok.so bitcoin-cli-ok.o  libbitcoin_server.a libbitcoin_common.a univalue/.libs/libunivalue.a libbitcoin_util.a crypto/libbitcoin_crypto.a libzcash.a snark/libsnark.a ./leveldb/libleveldb.a ./leveldb/libmemenv.a secp256k1/.libs/libsecp256k1.a libbitcoin_zmq.a -L/home/zcash/depends/x86_64-unknown-linux-gnu/lib -lzmq -lstdc++   libbitcoin_wallet.a -L/home/zcash/depends/x86_64-unknown-linux-gnu/share/../lib -lboost_system -lboost_filesystem -lboost_program_options -lboost_thread -lboost_chrono -ldb_cxx-6.2 -pthread -L/home/zcash/depends/x86_64-unknown-linux-gnu/lib -lssl -lcrypto -ldl   -pthread -L/home/zcash/depends/x86_64-unknown-linux-gnu/lib -lcrypto -ldl   -L/home/zcash/depends/x86_64-unknown-linux-gnu/lib -levent_pthreads -levent   -L/home/zcash/depends/x86_64-unknown-linux-gnu/lib -levent   crypto/libbitcoin_crypto.a -lgmp -lgmpxx -lboost_system -lcrypto -lsodium -lrustzcash -ldl  -lanl
bitcoin-cli-ok.o: bitcoin-cli-ok.cpp
	$(CC) $(CFLAGS) $(TEST_INCLUDES) -DHAVE_CONFIG_H -c bitcoin-cli-ok.cpp -o bitcoin-cli-ok.o

libzcash.a: zcash/libzcash_a-IncrementalMerkleTree.o zcash/libzcash_a-NoteEncryption.o zcash/libzcash_a-Address.o zcash/libzcash_a-JoinSplit.o zcash/libzcash_a-Proof.o zcash/libzcash_a-Note.o zcash/libzcash_a-prf.o zcash/libzcash_a-util.o
	@echo "  AR      " ;ar cr libzcash.a zcash/libzcash_a-IncrementalMerkleTree.o zcash/libzcash_a-NoteEncryption.o zcash/libzcash_a-Address.o zcash/libzcash_a-JoinSplit.o zcash/libzcash_a-Proof.o zcash/libzcash_a-Note.o zcash/libzcash_a-prf.o zcash/libzcash_a-util.o


zcash/libzcash_a-IncrementalMerkleTree.o: zcash/IncrementalMerkleTree.cpp
	@echo "  CXX     " ;g++ $(CFLAGS) $(TEST_INCLUDES) -DHAVE_CONFIG_H  -I. -I../src/config   -I/home/zcash/depends/x86_64-unknown-linux-gnu/share/../include -I./leveldb/include -I./leveldb/helpers/memenv -I/home/zcash/depends/x86_64-unknown-linux-gnu/include   -I/home/zcash/depends/x86_64-unknown-linux-gnu/include   -I./secp256k1/include -I./snark -I./snark/libsnark -I./univalue/include  -DMONTGOMERY_OUTPUT -I/home/zcash/depends/x86_64-unknown-linux-gnu/share/../include/    -MT zcash/libzcash_a-IncrementalMerkleTree.o -MD -MP -MF zcash/.deps/libzcash_a-IncrementalMerkleTree.Tpo -c zcash/IncrementalMerkleTree.cpp -o zcash/libzcash_a-IncrementalMerkleTree.o
